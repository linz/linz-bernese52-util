#!/usr/bin/gnss_ftp_mirror -v
# Example configuration file:
#
# Note all configuration item values can contain references to other configuration
# item values as {xxxxx}, where xxx is the other item.  But note special values
# for date components and file names that should not be used.

# Organisation directory for sitelogs

orgdir=geonet
basedir={ENV:BERNESE_DATAPOOL}/sitelogs/{orgdir}

# RemoteUri is the the base of the remote directory

RemoteUri=ftp://ftp.geonet.org.nz/gps

RemoteUser=anonymous

RemotePassword=positionz@linz.govt.nz

TimeOut 30

# Delay in seconds added after each successful download to be polite to server

DownloadWait 1

# If a download fails the script will try to reconnect to the server
# The following options control the reconnection 

MaxReconnectionTries 5

# Time delay in seconds between reconnection attempts

ReconnectionWait 5

# Auto reconnect after specified number of downloads

MaxDownloadsPerConnection 100

# Maximum runtime in minutes - once this time has expired the job will finish

MaxRunTime 120

# StatusFile - if this is defined then at the completion of the run there
# will be a file named either xxx.success or xxx.fail.  The age of this can
# be tested with the MinTimeSinceLastRun option.  This specifies either a 
# single time, or two times (since success and since failure).  Time can
# be followed by h or d for hours or days (eg 5d).  Default is hours.  
# If the script is run sooner than the minimum time then it will stop 
# immediately.

StatusFile {basedir}/.mirror_status
MinTimeSinceLastRun 20h 4h

# RemotePath is the path to the files to download.
#
# Can include {yyyy},{yy},{mmmm}, {mmm},{mm},{ddd},{dd} which will map to 
# the corresponding date strings (mmm is 3 letter month name, mmmm is the 
# full month name). Will also accept Mmm, MMM, Mmmm, MMMM for different 
# capitalisation.

# Also can accept {code} or {CODE} for upper or lower case four character
# codes which will match a valid code. Use {Code} for a case insensitive
# code match.
# 
# These will be replaced with values corresponding to the maximum number
# of days before the current date to process.  Can also include ? for any
# character, and * for any set of characters.

RemoteDir=/sitelogs/xml

# RemoteFileRe.  Remote file names are matched against this regular expression.
# Files that match are candidates for downloading.  
# This can include any of the time and code components, eg {ddd}. Also it
# can include regular expression # capture groups (?<xxx>...) to capture 
# fields that can be used in the target path.  

RemoteFileRe={code}*.xml

# Target directory.  This can be based absolute, or relative to the location
# of the configuration file (defined as ~).  Can include time components
# as for RemovePath.  Can also include {filename} to use the source filename.

TargetPath={basedir}/{filename}

# Marker file.  By default the script checks for the existence of the target 
# file.  If it exists and is of the correct size it is downloaded again.  The 
# script can instead use a marker file into which the downloaded size is written.
# This allows the downloaded file to be removed or otherwise changed without 
# being reprocessed.

#MarkerPath=~/{yyyy}/{ddd}/{filename}.downloaded

# Processing script. Command to run once a file has been downloaded.  The script
# is run in the target directory.  The command can include parameters, and can
# include the replacement strings for filename, code, etc.
#
# If PostDownloadCommandChDir evaluates to true then the script changes to the 
# download directory to execute the command.

#PostDownloadCommand process_downloaded_file.sh {filename}
PostDownloadCommandChDir 1

# Codes to download.  Use Codes * (or omit codes altogether), to download
# all available codes.

Codes 2406 AHTI AKTO ANAU ARTA ATIA AUCK AUKT AVLN BHST
Codes BIRF BLUF BM8A BNET BTHL CAST CHAT CHTI CKID CLIM 
Codes CLRR CLS3 CLS4 CLS5 CLS6 CLSG CLSK CMBL CNCL CNST 
Codes CORM DNVK DUND DUNT DURV FALE FRTN GDS1 GEON GISB 
Codes GLDB GLOK GNBK GRAC GRNG GUNR HAAS HAMT HANA HANM 
Codes HAST HIKB HOKI HOLD HORN KAHU KAIK KAPT KARA KAWK 
Codes KERE KOKO KORO KTIA KUTA LDRZ LEVN LEXA LEYL LKTA 
Codes LOK1 LOOK LRR1 LYTT MAHA MAHI MAHO MAKO MANG MAST 
Codes MATW MAVL MCNL METH MING MKNO MNHR MQZG MRBL MTBL 
Codes MTJO MTPR MTQN MUL1 NETT NIUC NLS1 NLS2 NLSN 
Codes NMAI NPLY NRRD NRSW OHIN OKOH OPTK OROA OTAK OUSD 
Codes PAEK PAKI PALI PARI PARW PAWA PGKH PGNE PILK PKNO 
Codes PNUI PORA PRTU PTOI PUKE PYGR QUAR RAHI RAKW RAUL 
Codes RAUM RAWI RDLV RGAR RGAW RGCR RGHD RGHL RGHR RGKA 
Codes RGKW RGLI RGMK RGMT RGON RGOP RGRE RGRR RGTA RGUT 
Codes RGWC RGWI RGWV RIPA SCTB SEDD SNST SUTT TAKL TAKP 
Codes TAUP TAUW TEMA TEN2 TENN TGHO TGHR TGOH TGRA TGRI 
Codes TGTK TGWH THAP TINT TKAR TKHL TORY TRAV TRNG TRWH 
Codes TURI UTK1 UTK2 UTK3 UTK4 UTKU V27B V47B VAVS VEXA 
Codes VGDR VGET VGFW VGKR VGMO VGMT VGNG VGNT VGOB VGOT 
Codes VGPK VGT2 VGT8 VGTM VGTR VGTS VGWH VGWN VGWT WAHU 
Codes WAIM WAKA WANG WARK WEST WGTN WGTT WHKT WHNG WHVR 
Codes WITH WMAT WPAW WPUK WRA1 WRAU WRPA YALD

# Number of days before current date to start and end download
# Set the same if the download is insensitive to date...

StartAge 1
EndAge 1
